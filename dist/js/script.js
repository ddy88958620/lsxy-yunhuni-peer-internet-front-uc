function bytesToSize(e){var a=["Bytes","KB","MB"];if(0==e)return"n/a";var t=parseInt(Math.floor(Math.log(e)/Math.log(1024)));return(e/Math.pow(1024,t)).toFixed(1)+" "+a[t]}function checkForm(){return!!parseInt($("#w").val())||($(".error").html("Please select a crop region and then press Upload").show(),!1)}function updateInfo(e){$("#x1").val(e.x),$("#y1").val(e.y),$("#x2").val(e.x2),$("#y2").val(e.y2),$("#w").val(e.w),$("#h").val(e.h)}function clearInfo(){$(".info #w").val(""),$(".info #h").val("")}function fileSelectHandler(){var e=$("#image_file")[0].files[0];$(".error").hide();var a=/^(image\/jpeg|image\/png)$/i;if(!a.test(e.type))return void $(".error").html("请选择图像文件").show();if(e.size>256e3)return void $(".error").html("文件太大，请选择一张稍小点的图片").show();var t=document.getElementById("preview"),n=new FileReader;n.onload=function(a){t.src=a.target.result,t.onload=function(){$(".step2").fadeIn(500);var a=bytesToSize(e.size);$("#filesize").val(a),$("#filetype").val(e.type),$("#filedim").val(t.naturalWidth+" x "+t.naturalHeight);var n,r,o;"undefined"!=typeof n&&n.destroy(),$("#preview").Jcrop({minSize:[32,32],aspectRatio:1,bgFade:!0,bgOpacity:.3,onChange:updateInfo,onSelect:updateInfo,onRelease:clearInfo},function(){var e=this.getBounds();r=e[0],o=e[1],n=this})}},n.readAsDataURL(e)}