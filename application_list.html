<!DOCTYPE html>
<html>
<body>

<!-- header -->
<div class="include" data-include="header"></div>
<!-- end header -->

<section class='aside-section'>
    <section class="hbox stretch">
        <!-- .aside -->
        <aside class="bg-Green lter aside hidden-print include" data-include="aside" id="nav"></aside>
        <!-- /.aside -->

        <section id="content">
            <section class="hbox stretch">
                <!-- 如果没有三级导航 这段代码注释-->
                <aside class="bg-green lter aside-sm hidden-print ybox" id="subNav">
                    <section class="vbox">
                        <div class="wrapper header"><span class="margin_lr"></span><span class="margin_lr border-left">&nbsp;应用管理</span>
                        </div>
                        <section class="scrollable">
                            <div class="slim-scroll">
                                <!-- nav -->
                                <nav class="hidden-xs">
                                    <ul class="nav">
                                        <li>
                                            <div class="aside-li-a active">
                                                <a href="application_list.html">应用列表</a>
                                            </div>
                                        </li>
                                        <li>
                                            <div class="aside-li-a">
                                                <a href="application_create.html">创建应用</a>
                                            </div>
                                        </li>
                                    </ul>
                                </nav>
                            </div>
                        </section>

                    </section>
                </aside>
                <aside>
                    <section class="vbox xbox">
                        <!-- 如果没有三级导航 这段代码注释-->
                        <div class="head-box"><a href="#subNav" data-toggle="class:hide"> <i
                                class="fa fa-angle-left text"></i> <i class="fa fa-angle-right text-active"></i> </a>
                        </div>
                         <div class="wrapper header">
                           <span class="border-left">&nbsp;应用列表</span>
                         </div>
                        <section class="scrollable wrapper w-f">
                            <section class="panel panel-default yunhuni-personal">
                                <div class="row m-l-none m-r-none bg-light lter">
                                    <div class="col-md-12 padder-v fix-padding">
                                        <a href="application_create.html" class="btn btn-primary query">创建应用</a>
                                    </div>
                                </div>
                            </section>
                            <section class="panel panel-default pos-rlt clearfix ">
                              <table class="table table-striped cost-table-history tablelist" id="tableModal">
                                    <thead>
                                      <tr>
                                        <th>#</th>
                                        <th>应用名称</th>
                                        <th>应用标识</th>
                                        <th>服务类型</th>
                                        <th>应用状态</th>
                                        <th>应用创建时间</th>
                                        <th>操作</th>
                                      </tr>
                                    </thead>
                                    <tbody>
                                      <tr id="app-1">
                                        <td scope="row">1</td>
                                        <td>应用名称</td>
                                        <td>123456789456123456</td>
                                        <td>呼叫中心</td>
                                        <td><span class="success " id="statusapp-1">已上线</span></td>
                                        <td>2016-01-01 10:10:00</td>
                                        <td class="operation">
                                            <a href="application_detail.html">详情</a> <span ></span>
                                            <a onclick="delapp(1,1)">删除</a> <span ></span>
                                            <span class="apply" id="trb-1"><a onclick="lineapp(1)">下线</a></span>
                                        </td>
                                      </tr>
                                      <tr id="app-2">
                                          <td scope="row">2</td>
                                          <td>应用名称</td>
                                          <td>123456789456123456</td>
                                          <td>语音</td>
                                          <td><span class="success" id="statusapp-2">已上线</span></td>
                                          <td>2016-01-01 10:10:00</td>
                                          <td class="operation">
                                              <a href="application_detail.html">详情</a> <span ></span>
                                              <a onclick="delapp(2,2)">删除</a> <span ></span>
                                              <a onclick="tabtarget(2,1)" >申请上线</a>
                                          </td>
                                      </tr>
                                      <tr id="app-3">
                                          <td scope="row">3</td>
                                          <td>应用名称</td>
                                          <td>123456789456123456</td>
                                          <td>语音</td>
                                          <td><span class="nosuccess" id="statusapp-3">未上线</span></td>
                                          <td>2016-01-01 10:10:00</td>
                                          <td class="operation">
                                              <a href="application_detail.html">详情</a> <span ></span>
                                              <a onclick="delapp(3,2)" >删除</a> <span ></span>
                                              <a onclick="tabtarget(3,2)" >申请上线</a>
                                          </td>
                                      </tr>
                                      <tr id="app-4">
                                        <td scope="row">3</td>
                                        <td>应用名称</td>
                                        <td>123456789456123456</td>
                                        <td>语音</td>
                                        <td><span class="nosuccess" id="statusapp-4">未上线</span></td>
                                        <td>2016-01-01 10:10:00</td>
                                        <td class="operation">
                                          <a href="application_detail.html">详情</a> <span ></span>
                                          <a onclick="delapp(4,2)" >删除</a> <span ></span>
                                          <a onclick="tabtarget(4,1)" >申请上线</a>
                                        </td>
                                      </tr>

                                    </tbody>
                                  </table>
                            </section>
                            <section class="panel panel-default yunhuni-personal">
                             <nav class='pageWrap'>
                                <ul class="pagination">
                                  <li>
                                    <a href="#" aria-label="Previous">
                                      <span aria-hidden="true">&laquo;</span>
                                    </a>
                                  </li>
                                  <li class="active"><a href="#">1</a></li>
                                  <li><a href="#">2</a></li>
                                  <li><a href="#">3</a></li>
                                  <li><a href="#">4</a></li>
                                  <li><a href="#">5</a></li>
                                  <li>
                                    <a href="#" aria-label="Next">
                                      <span aria-hidden="true">&raquo;</span>
                                    </a>
                                  </li>
                                </ul>
                              </nav>
                            </section>

                        </section>
                    </section>
                </aside>
            </section>
            <a href="#" class="hide nav-off-screen-block" data-toggle="class:nav-off-screen" data-target="#nav"></a>
        </section>
    </section>
</section>

<input type="hidden" value="" id="modal-appid" />

<!---mobilebox-->
<div class="shadow-bg" id="show-bg"></div>
<div id="mobilebox-1" class="appliation-modal-box" style="display: none;">
    <div class="addmobile1" >
        <div class="title">应用上线流程<a class="close_a modalCancel" data-type="1"></a></div>
        <div class="content" >
            <!--nav-->
            <div class="nav-modal-box">
                <ul class="nav-modal">
                    <li><a class="spot" data-action="1"></a><span class="lines"></span> </li>
                    <li><a class="spot" data-action="2"></a><span class="lines"></span></li>
                    <li><a class="spot" data-action="3"></a></li>
                </ul>
                <ul class="nav-modal-text navw-270">
                    <li><span class="text">实名认证</span> </li>
                    <li><span class="text">号码绑定</span> </li>
                    <li class="ml-20 mr-0"><span class="text">上线</span>  </li>
                </ul>
            </div>

            <div class="contentModal" style="display: " data-action="1">
                <!--未认证显示-->
                <div class="input text-center" style="display: none">
                    <img src="images/index/l6.png" alt="" class="sre" />
                    <p>您还没有经过实名认证，请进行实名认证！</p>
                </div>
                <div class="input text-center" style="display: none">
                    <a href="" type="button"  class="btn btn-primary btn-box">实名认证</a>
                </div>
                <!---end--->
                <!--认证显示-->
                <div class="input text-center" >
                    <img src="images/index/l6.png" alt="" class="sre" />
                    <p>您已成功进行实名认证，点击进入下一步!</p>
                </div>
                <div class="input text-center" >
                    <a type="button"  class="btn btn-primary btn-box tabModalBtn"  data-id="2" data-fun="creatIVR()">下一步</a>
                </div>
                <!---end--->
            </div>

            <div class="contentModal" style="display: none" data-action="2">

              <!--可选号码-->
              <div class="input text-center">
                <div class="info">
                  若您选择开通IVR功能，则需要从我的号码列表中选择一个可呼入的号码与该应用绑定
                </div>
              </div>
              <div class="phone-table">
                <table class="table table-striped">
                  <thead>
                  <tr>
                    <th></th>
                    <th>手机号码</th>
                    <th class="text-center">可呼入</th>
                    <th class="text-center">可呼出</th>
                    <th class="text-left-fixed"><span class="">归属地</span></th>
                  </tr>
                  </thead>
                  <tbody id="phonelist">
                  <tr>
                    <td><input type="checkbox" name="" /></td>
                    <td>13611460866</td>
                    <td class="text-center" >✔</td>
                    <td class="text-center">✘</td>
                    <td class="text-left-fixed">0757</td>
                  </tr>

                  </tbody>
                </table>
              </div>
              <div class="input text-center" >
                <a type="button"  class="btn btn-primary btn-box tabModalBtn" data-id="3" data-fun="createorder()" >下一步</a>
              </div>

              <!--没有可选号码-->
              <div class="input text-center">
                我的号码列表没有可选号码，如需租用号码，请前往“号码管理”中的“我的号码”
              </div>
              <div class="input text-center" >
                <a type="button"  class="btn btn-primary btn-box tabModalBtn" href="number_call.html">立即前往</a>
              </div>

                <!--<div class="input text-center">
                    <p>您选择开通IVR功能，我们给您分配了一个IVR号码供应用使用IVR功能</p>
                </div>
                <div class="input text-center">
                    <div class="defulatTips" id="creatIVR" >
                        0898-77887748858
                    </div>
                    <a onclick="nolike()" class="font14">不喜欢 换一个?</a>
                </div>
                <div class="hideIVR">
                </div>-->

            </div>

            <div class="contentModal" style="display: none" data-action="4">
                <div class="input text-center mt-0">
                    <p>您需要支付：<span class="money">998.00</span> 元&nbsp;&nbsp;&nbsp; 账号余额：0.00 元 &nbsp;&nbsp;&nbsp; <span class="nomoney">!!余额不足</span>&nbsp;&nbsp;&nbsp;<a href="cost_recharge_sure.html">充值</a> </p>
                </div>
                <div class="input text-center mb-0 mt-0">
                    <div class="defulatTips">IVR号码：121212121</div>
                    <div class="defulatTips">IVR号码租用费：1000元</div>
                    <div class="defulatTips">IVR功能使用费：100元/月</div>
                </div>
                <div class="ivrserver"><input type="checkbox" name="readcheckbox" id="readbook" />已阅读<a target="_blank" href="ivragreement.html" >IVR服务协议</a></div>
                <div class="input text-center mt-0" >
                    <a type="button"  class="btn btn-primary btn-box tabModalBtn" data-id="4" data-fun="pay()">确认支付</a>
                    <a type="button"  class="btn btn-primary btn-box" onclick="resetIVR()">重新选择</a>
                </div>
            </div>

            <div class="contentModal" style="display:none " data-action="3">
                <div class="input text-center" >
                    <img src="images/index/l1.png" alt="" class="sre" />
                    <p>上线成功</p>
                </div>
                <div class="input text-center" >
                    <a href="" type="button"  class="btn btn-primary btn-box tabModalBtn">上线成功</a>
                </div>
            </div>
            <div class="input">
                <div class="tips-error moadltips1 text-center" style="display: none">错误提示信息</div>
            </div>

        </div>
    </div>

</div>


<div id="mobilebox-2" class="appliation-modal-box" style="display: none" >
    <div class="addmobile1" >
        <div class="title">应用上线流程<a class="close_a modalCancel" data-type="2"></a></div>
        <div class="content" >
            <!--nav-->
            <div class="nav-modal-box">
                <ul class="nav-modal navw-150">
                    <li><a class="spot" data-action="1"></a><span class="lines"></span> </li>
                    <li><a class="spot" data-action="2"></a></li>
                </ul>
                <ul class="nav-modal-text navw-150">
                    <li><span class="text">实名认证</span> </li>
                    <li class=" mr-0"><span class="text">上线</span>  </li>
                </ul>
            </div>

            <div class="contentModal" style="display: " data-action="1">
                <!--未认证显示-->
                <div class="input text-center" style="display: none">
                    <img src="images/index/l6.png" alt="" class="sre" />
                    <p>您还没有经过实名认证，请进行实名认证！</p>
                </div>
                <div class="input text-center" style="display: none">
                    <a href="" type="button"  class="btn btn-primary btn-box">实名认证</a>
                </div>
                <!---end--->
                <!--认证显示-->
                <div class="input text-center">
                    <img src="images/index/l6.png" alt="" class="sre" />
                    <p>您已成功进行实名认证，点击进入下一步!</p>
                </div>
                <div class="input text-center" >
                    <a type="button"  class="btn btn-primary btn-box tabModalBtn" data-id="2" >下一步</a>
                </div>
                <!---end--->
            </div>

            <div class="contentModal" style="display: none" data-action="2">
                <div class="input text-center" >
                    <img src="images/index/l1.png" alt="" class="sre" />
                    <p>上线成功</p>
                </div>
                <div class="input text-center" >
                    <a href="" class="btn btn-primary btn-box tabModalBtn"  data-fun="" >上线成功</a>
                </div>
            </div>
            <div class="input">
                <div class="tips-error moadltips1 text-center" style="display: none">错误提示信息</div>
            </div>

        </div>
    </div>

</div>

<div class="tips-toast"></div>



<script src="js/app.v2.js"></script> <!-- Bootstrap --> <!-- App -->
<script src="js/charts/flot/jquery.flot.min.js" cache="false"></script>
<script src="js/bootbox.min.js"></script>
<script src="js/charts/flot/demo.js" cache="false"></script>
<script src="js/jquery.cookie.min.js"></script>
<script src="js/include.js"></script>
<script src="bower_components/bootstrapvalidator/dist/js/bootstrapValidator.min.js"></script>
<script type="text/javascript" src='./js/bootstrap-datepicker/js/bootstrap-datepicker.js'> </script>
<script type="text/javascript" src='./js/bootstrap-datepicker/locales/bootstrap-datepicker.zh-CN.min.js'> </script>
<script type="text/javascript" src='./js/application/list.js'> </script>
<script>


  /**
   * @param id 应用id
   * @param type 类型
   * type 1 ivr  2no ivr
   */
  function tabtarget(id,type){
    //赋值appid
    $('#modal-appid').val(id);
    //步骤
    var index = 0;
    if(index==0){
        cleanModal(type);
    }else{
        //当前步骤

    }
    modalAction(1);
    showBox(type);
  }

  var ivrnumber = 1;

  //生成IVR
  function creatIVR(){
    //加载号码列表
    var html  = "";
    var data =  [
      {
        phone: '13611460983',
        call: 0,
        callout: 1,
        place: '0757',
        quality: 3
      },
      {
        phone: '13611460983',
        call: 0,
        callout: 1,
        place: '0757',
        quality: 3
      },
      {
        phone: '13611460983',
        call: 0,
        callout: 1,
        place: '0757',
        quality: 3
      },
      {
        phone: '13611460983',
        call: 0,
        callout: 1,
        place: '0757',
        quality: 3
      }
    ]

    var isCall =  ["✔", "✘"] ;
    //特殊判断 <i class="fa fa-exclamation-triangle"></i>


    if(data.length>0){
        for (var i = 0 ; i< data.length ; i ++){
          html += '<tr><td><input type="checkbox" name="phonelist" value="'+data[i].phone+'" /></td>'
          //特殊判断 <i class="fa fa-exclamation-triangle"></i>
          html += '<td data-toggle="tooltip" data-placement="right"  title="此号码为该应用上一次进行号码绑定时选择的号码">'+data[i].phone+'<i class="fa fa-exclamation-triangle cursor orange" ></i> </td>'
          //普通号码
          //html +='<td>'+data[i].phone+'</td>'

          html +='<td class="text-center" >'+isCall[data[i].call]+'</td><td class="text-center" >'+isCall[data[i].callout]+'</td><td class="text-left-fixed" >'+data[i].place+'</td></tr>'
        }
    }

    $('#phonelist').html(html)




    $('.hideIVR').html('');
    //异步生成
    var ivr = ['02000100','02000200','02000300','0200400','0200500'];
    for (var i = 0; i < ivr.length; i++) {
      $('.hideIVR').append('<sapn class="hideIVR-p-'+(i+1)+'">'+ivr[i]+'</sapn>');
    }
    //赋值第一个
    $('#creatIVR').html(ivr[0]);
    ivrnumber = 1;
    return true;
  }

  function nolike(){
    ivrnumber++;
    if(ivrnumber==6){
      ivrnumber = 1;
    }
    var ivr = $('.hideIVR-p-'+ivrnumber).html();
    $('#creatIVR').html(ivr);

  }





  /**
   * 应用id
   * status 该应用状态
   */
  function delapp(id,status){
    bootbox.setLocale("zh_CN");
    if(status==1){
      bootbox.alert("当前应用正在运营中，请将起下线后进行删除", function(result) {}); return;
    }
    if(status==2){
      bootbox.confirm("删除应用：将会使该操作即时生效，除非您非常清楚该操作带来的后续影响", function(result) {
        if(result){
          showtoast('删除成功'+id);
          $('#app-'+id).remove();
        }else{
          alert('删除操作');
        }
      });
    }
  }


  //应用下线
  function lineapp(id){
    bootbox.setLocale("zh_CN");
    bootbox.confirm("下线应用：将会使该操作即时生效，除非您非常清楚该操作带来的后续影响", function(result) {
      if(result){
        $('#trb-'+id).html('');
        $('#statusapp-'+id).html('未上线').removeClass('success').addClass('nosuccess');
        $('#trb-'+id).html('<a onclick="tabtarget('+id+')">申请上线</a>');
        showtoast('下线成功');
      }else{
        showtoast('取消');
      }

    });
  }




  //监听支付状态 返回true success
  function syncpay(){
    return true;
  }

  function showtoast(tips,url) {
    $('.tips-toast').hide().html('');
    $('.tips-toast').css('display','block').html(tips);
    setInterval(function(){hidetoast(url);},3000)
  }
  function hidetoast(url){
     $('.tips-toast').hide();
    if(url!=undefined && url!='' && url!='undefined'){
        window.location.href=url;
    }
  }



  function createorder(){

    var number  = ''
    $('input[name="phonelist"]:checked').each(function(){
      if(number!=''){

      }
      number.push($(this).val())
      console.log("选中"+$(this).val())
    })

    console.log(number);

    //异步请求




    if(number.length<=0){
      showtoast('请选择一个可呼入的号码')
      return false
    }
    //异步绑定号码



    return true;
  }

  function pay(){

      if(!$('#readbook').is(':checked')) {
          showtoast('请先阅读IVR协议');
          return false;
      }
      return true;
  }

  //重选择事件
  function resetIVR(){
      tabModalBtn(2,'creatIVR()');
  }


</script>

</body>
</html>

